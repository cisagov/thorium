ARG IMAGE="ubuntu:22.04"
FROM $IMAGE

ARG PIP_INDEX_URL

WORKDIR /app

RUN apt update && \
    apt install -y python3 python3-pip git file cabextract p7zip-full tar unzip rpm2cpio cpio build-essential binutils coreutils xterm jq && \
    apt clean && \
    rm -rf /var/lib/apt/lists/*

# install from pypi
RUN pip install cve-bin-tool

# copy in our run script
COPY scan.py /app/scan.py

# add our custom checkers
COPY checkers/* /usr/local/lib/python3.10/dist-packages/cve_bin_tool/checkers/

ENTRYPOINT ["python3", "/app/scan.py"]
