<!DOCTYPE HTML>
<html lang="en" class="navy sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Viewing Tool Results - Thorium</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Thorium</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="viewing-results"><a class="header" href="#viewing-results">Viewing Results</a></h1>
<p>Tool results are created when a <code>pipeline</code> is run on a target <code>file</code>. The running <code>pipeline</code> instance is called a
<code>reaction</code> and may involve running several tools (called <code>images</code>) on the target <code>file</code>. The analysis artifacts created
by each tool are then automatically stored in Thorium after each <code>pipeline</code> stage has completed. We organize tool
results based on the name of the tool/image rather than the name of the pipeline where that tool was run.</p>
<p>Tools may generate several types of result output, including renderable and downloadable formats. These artifacts
include:</p>
<ul>
<li>results: renderable data including basic text and JSON formatted tool output</li>
<li>result-files: downloadable files produced by the tool and any tool results larger than 1MB</li>
<li>children: unpacked or transformed files that Thorium treats like sample files due to potential maliciousness.</li>
</ul>
<p>You can view or download results and child files from both the Web UI and Thorctl.</p>
<h2 id="web-ui"><a class="header" href="#web-ui">Web UI</a></h2>
<hr />
<h3 id="results-and-result-files"><a class="header" href="#results-and-result-files">Results and Result Files</a></h3>
<p>You can navigate to the details page for a file using the <code>sha256</code> hash of that file, or by browsing and searching
through Thorium's data. If you are already on the file details page and see your reaction's have completed, refresh the
page to get the latest tool results!</p>
<script>
  let base = window.location.origin;
  document.write("<pre>");
  document.write("<a href=" + base + "/file/SHA256" + ">");
  document.write(base + "/file/[SHA256]");
  document.write("</a>");
  document.write("</pre>");
</script>
<p>Once you load the file details page, click the <code>Results</code> tab that's displayed after the submission info section. You
should see tool results that you can scroll through as shown in the video below.</p>
<video autoplay loop controls>
  <source src="../static_resources/results/results-view.mp4", type="video/mp4">
</video>
<p>You can also jump to results by clicking on the tools corresponding tag for a particular tool result.</p>
<video autoplay loop controls>
  <source src="../static_resources/results/results-jump-by-tag.mp4", type="video/mp4">
</video>
<p>Tools can create renderable results as well as result files. If a tool produces a result files, those files can be
downloaded using the links at the bottom of the result section for that tool.</p>
<video autoplay loop controls>
  <source src="../static_resources/results/results-files-download.mp4", type="video/mp4">
</video>
<p>The number of result files that a tool produced will be displayed on the header of the results section. That file
count badge can be clicked to jump to the result files links.</p>
<video autoplay loop controls>
  <source src="../static_resources/results/results-files-view.mp4", type="video/mp4">
</video>
<h3 id="children-files"><a class="header" href="#children-files">Children Files</a></h3>
<p>Many tools will produce entirely new samples called <code>children files</code> that are saved in Thorium after the tool exits.
For example, an unpacking tool might remove protective/obfuscating layers of a given malware sample in order to unpack
the core payload and save it as a new sample in Thorium for further analysis. The sample that a tool was run on to
produce a child file its <code>parent file</code>. The origin information on a child file's details page contains a convenient link
to the child's parent. Clicking the link will take you to the sample details of the parent file.</p>
<p align="center">
    <img width="800" src="./../static_resources/results/children-files-parent-link.png">
</p>
<h2 id="thorctl"><a class="header" href="#thorctl">Thorctl</a></h2>
<hr />
<p>You can download results for specific samples using Thorctl with the following command:</p>
<pre><code class="language-bash">thorctl results get &lt;SHA256&gt;
</code></pre>
<p>Download results for multiple samples by passing multable file SHA's:</p>
<pre><code class="language-bash">thorctl results get &lt;SHA256-1&gt; &lt;SHA256-2&gt; &lt;SHA256-3&gt;
</code></pre>
<p>If you want to download results for specific tools then you can use the following command:</p>
<pre><code class="language-bash">thorctl results get --tools &lt;TOOL&gt; --tools &lt;TOOL&gt; &lt;SHA256&gt;
</code></pre>
<p>You can also get results for any samples with a certain tag with the following command:</p>
<pre><code class="language-bash">thorctl results get --tags Dataset=Examples
</code></pre>
<p>The tool and tag flags can be set together to get the results of running a tool on samples with a particular
characteristic:</p>
<pre><code class="language-bash">thorctl results get --tools analyzer --tags Packed=True
</code></pre>
<p>The number of results from which Thorctl downloads files is limited to prevent inadvertent massive download requests.
To change the limit, use the <code>--limit</code>/<code>-l</code> flag:</p>
<pre><code class="language-bash">thorctl results get --tags Incident=10001234 --limit 100
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../users/spawning_reactions.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../users/searching_results.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../users/spawning_reactions.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../users/searching_results.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../editor.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
